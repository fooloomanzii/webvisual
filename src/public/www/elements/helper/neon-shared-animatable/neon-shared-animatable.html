<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/neon-animation/neon-shared-element-animation-behavior.html">
<link rel="import" href="../bower_components/iron-resizable-behavior/iron-resizable-behavior.html">

<!--
`neon-shared-animatable`
neon-animatable with autofinding elements

@demo demo/index.html
-->

<dom-module id="neon-shared-animatable">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <content></content>
  </template>

</dom-module>

<script>

  Polymer({

    is: 'neon-shared-animatable',

    behaviors: [
      Polymer.NeonSharedElementAnimationBehavior,
      Polymer.IronResizableBehavior
    ],

    properties: {

      animationConfig: {
        type: Object,
        value: function() {
          return {}
        },
        observer: 'checkConfig'
      },

      sharedElements: {
        type: Object,
        value: function() {
          return {}
        },
        observer: 'checkShared'
      }
    },

    checkConfig: function() {
      // Those changes should not be notified by this observer (callstack overflow)
      for (var alias in this.animationConfig) {
        if (this.animationConfig[alias].id) {
          if (this.animationConfig[alias].fromPage) {
            this.animationConfig[alias].fromPage = this;
          }
          if (this.animationConfig[alias].toPage) {
            this.animationConfig[alias].toPage = this;
          }
        }
      }
    },

    checkShared: function() {
      // Those changes should not be notified by this observer (callstack overflow)
      for (var id in this.sharedElements) {
        this.sharedElements[id] = this.queryEffectiveChildren(this.checkShared[id]);
      }
    }

  });

</script>
